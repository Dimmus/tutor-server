<% @page_header = "Salesforce / Tutor Integration" %>

<h3>API User Setup</h3>

<p>When Tutor makes calls to Salesforce's API, it must do so on behalf of a
  specific Salesforce user.  At any one time, Tutor has information for either
  zero or one such user.  Use the link below to set the current user that Tutor
  acts as when calling the Salesforce API.</p>

<div style="margin: 30px 0px">
<p>
<% if @user.present? %>
  The current Salesforce user is <b><%= @user.name %></b>.
<% else %>
  There <b>is no</b> Salesforce user currently set.
<% end %>
</p>
</div>

<%= link_to "Set Tutor's Salesforce User", "/auth/salesforce?redirect_uri=http://localhost:3001/auth/salesforce/callback", id: "sign_in", class: 'btn btn-primary' %>

<%= link_to "Clear Salesforce User", admin_salesforce_destroy_user_path, class: 'btn btn-danger pull-right', method: :delete %>

<hr/>

<h3>Import Courses</h3>

<p>Use the button below to trigger an import of courses from Salesforce.  For each Class Size object within Salesforce that are approved for a Concept Coach course but that don't yet have such a course, a course will be created and information written back to the Salesforce record.  If the operation is unsuccessful, an error will be written to the Salesforce record.</p>

<%= form_tag(admin_salesforce_import_courses_path, method: :post, style: 'margin: 30px 0') do %>

  <div class="checkbox">
    <label>
      <%= check_box_tag :use_real_data,  {class: 'form-control'}%>
      <span class="checkbox-label">Use production Salesforce data</span>
      <p class="help-block">If unchecked, only records from "Denver University" will be imported.  If checked, real records with real teachers will be imported.</p>
    </label>
  </div>

  <%= submit_tag 'Import Courses', class: 'btn btn-primary' %>
<% end %>
